<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Games 1 ‚Äì Quiz</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="../css/style.css">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>

<div class="container py-5 text-center">
    <h2>Quiz Game</h2>

    <div id="quiz-question" class="h4 mb-4"></div>
    <div id="quiz-options" class="d-grid gap-2 col-6 mx-auto"></div>

    <div class="mt-4">
        Score: <span id="rate-span">0/0</span> |
        Correct: <span id="streak-span">0</span> |
        Avg Time: <span id="response-time-span">0</span>s
    </div>

    <div id="quiz-play-again" class="mt-4" style="display:none;">
        <button id="quiz-play-again-btn" class="btn btn-primary">Play Again</button>
    </div>
</div>

<!-- Wrong Answer Modal -->
<div class="modal fade" id="wrongAnswerModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body text-center">
        ‚ùå Wrong Answer!
      </div>
    </div>
  </div>
</div>

<!-- Completion Modal -->
<div class="modal fade" id="completionModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body text-center">
        üéâ Game Completed!
      </div>
    </div>
  </div>
</div>

<script>
function games1Js() {

    const originalQuestions = [
        {
            question: "Who is Tan Sri Dr. Lim Wee Chai?",
            answers: [
                { answer: "Founder of Top Glove", correct: true },
                { answer: "Scientist", correct: false },
                { answer: "Politician", correct: false }
            ]
        },
        {
            question: "Top Glove is famous for?",
            answers: [
                { answer: "Medical Gloves", correct: true },
                { answer: "Shoes", correct: false },
                { answer: "Phones", correct: false }
            ]
        }
    ];

    let questions = [];
    let stats = {
        questionsAsked: 0,
        correct: 0,
        currentTime: null,
        averageResponseTime: 0
    };

    function resetGames() {
        questions = JSON.parse(JSON.stringify(originalQuestions));
        stats = { questionsAsked: 0, correct: 0, currentTime: null, averageResponseTime: 0 };

        document.querySelector("#quiz-question").innerHTML = "";
        document.querySelector("#quiz-options").innerHTML = "";
        document.querySelector("#rate-span").innerHTML = "0/0";
        document.querySelector("#streak-span").innerHTML = "0";
        document.querySelector("#response-time-span").innerHTML = "0";
        document.querySelector("#quiz-play-again").style.display = "none";

        initiateGame();
    }

    function initiateGame() {
        displayQuestion(questions[0]);
    }

    function displayQuestion(q) {
        const question = document.querySelector("#quiz-question");
        const options = document.querySelector("#quiz-options");

        question.innerHTML = q.question;
        options.innerHTML = "";

        stats.questionsAsked++;
        stats.currentTime = new Date();

        q.answers.forEach(ans => {
            const btn = document.createElement("button");
            btn.className = "btn btn-outline-light quiz-ans-btn";
            btn.textContent = ans.answer;
            btn.dataset.correct = ans.correct;
            options.appendChild(btn);
        });
    }

    document.addEventListener("click", function(e){
        if(!e.target.classList.contains("quiz-ans-btn")) return;

        const correct = e.target.dataset.correct === "true";

        if(correct){
            stats.correct++;
            questions.shift();
            if(questions.length){
                displayQuestion(questions[0]);
            } else {
                document.querySelector("#quiz-play-again").style.display = "block";
                new bootstrap.Modal(document.getElementById("completionModal")).show();
            }
        } else {
            new bootstrap.Modal(document.getElementById("wrongAnswerModal")).show();
        }

        document.querySelector("#rate-span").innerHTML = stats.correct + "/" + stats.questionsAsked;
        document.querySelector("#streak-span").innerHTML = stats.correct;
    });

    document.querySelector("#quiz-play-again-btn")?.addEventListener("click", resetGames);

    resetGames();
}
games1Js();
</script>

</body>
</html>
